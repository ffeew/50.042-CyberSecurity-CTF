# Scam the Server

Scam the Server is a 2-part capture the flag (CTF) challenge. The first part is a warm-up to the second part, which is the main challenge. The flag for the first part is the port number of the second part.

To begin the challenge, download the files in this [folder](./Challenge).

Once you have completed the challenge and obtained the flag, upload the flag to the CTF server to check for correctness.

## Instructions for first challenge

In this challenge, you will be given a message and a MAC. You will need to scam the server into returning you a flag by sending to it a message that contains a magic word.

The server checks if the MAC matches with the message as well so simply modifying the message to the server will not work :p

The original message is: VDU=
The original MAC is: fb92d54b2136c756ee80b2d2d8fd925ceccd09f4

MAC is generated by: MAC = SHA1(secret_key||message)

The server expects inputs to be in this format: {"message": message, "MAC": mac}

### Hints:

1. The message is encoded in base64
2. Appending "flag" to the message will signal the server to return the flag
3. secret_key length = 16

To begin the challenge connect to port 12065
nc [this server IP] 12065

## Instructions for the second challenge

Last month, our overzealous rookie security engineers at Campbell Soup Security Pte. Ltd. decided to implement their own upgraded version of ElGamal in an oracle to encrypt our super secret patented Campbell Soup Security recipe (FLAG).

They used some new-fangled system that they found through a link on the ElGamal encryption Wikipedia page as a guide to build the oracle, but looks like they put more effort into the graphics than actually following the system. Sigh.

Unsurprisingly, we have received reports that an anonymous actor is continuously trying to decrypt our super secret patented Campbell Soup Security recipe using this rookie oracle.

Therefore, we have put the oracle under maintenance and our valued customers may only decrypt their own stocked up soup recipes for the time being. Of course, employees are still welcome to read our super secret patented Campbell Soup Security recipe.

Which brings us to today. It is with a heavy heart that we announce our imminent failure in securing our super secret patented Campbell Soup Security recipe. Despite our best efforts, we are seeing an increase of suspicious traffic in high volumes at perfectly precise intervals, and our senior security engineers tell us that the anonymous actor is minutes away from succeeding...
